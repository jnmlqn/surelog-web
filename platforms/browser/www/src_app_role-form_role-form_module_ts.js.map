{"version":3,"sources":["./src/app/role-form/role-form-routing.module.ts","./src/app/role-form/role-form.module.ts","./src/app/role-form/role-form.page.ts","./src/app/role-form/role-form.page.scss","./src/app/role-form/role-form.page.html"],"names":[],"mappings":"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","file":"src_app_role-form_role-form_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { RoleFormPage } from './role-form.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: RoleFormPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class RoleFormPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\nimport { RoleFormPage } from './role-form.page';\n\nimport { RoleFormPageRoutingModule } from './role-form-routing.module';\n\nimport { SharedComponentsModule } from '../components/shared-components.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RoleFormPageRoutingModule,\n    SharedComponentsModule\n  ],\n  declarations: [\n    RoleFormPage\n  ]\n})\nexport class RoleFormPageModule {}\n","import { ActivatedRoute } from '@angular/router';\nimport { ApiService } from '../services/api/api.service';\nimport { Component, OnInit } from '@angular/core';\nimport { ControllerService } from '../services/controller/controller.service';\n\n@Component({\n    selector: 'app-role-form',\n    templateUrl: './role-form.page.html',\n    styleUrls: ['./role-form.page.scss'],\n})\nexport class RoleFormPage implements OnInit {\n\n    id: string = null;\n    data: any = {\n        permissions: []\n    };\n    modules: any = [];\n    selected_modules: any = [];\n    loader: boolean = false;\n\n    constructor(\n        private route: ActivatedRoute,\n        private api: ApiService,\n        private controller: ControllerService,\n    ) {\n\n    }\n\n    ngOnInit() {\n        this.loader = true;\n        // get address details\n        this.api.get(`modules`)\n        .subscribe(\n            (res: any) => {\n                this.modules = res.data;\n\n                // Check parameters for role id\n                this.route.params.subscribe(params => {\n                    this.id = params.id;\n                    if(this.id !== null && this.id !== undefined) {\n                        // get role information\n                        this.api.get(`roles/${this.id}`)\n                        .subscribe(\n                            (res: any) => {\n                                this.data = {\n                                    name: res.data.name,\n                                    permissions: res.data.permissions\n                                };\n\n                                let selected_modules = [];\n                                for(const p of res.data.permissions) {\n                                    selected_modules.push(p.module_id);\n                                }\n\n                                this.selected_modules = selected_modules;\n                            },\n                            (err) => {\n                                this.controller.showErrorAlert(err);\n                            },\n                            () => {\n                                this.loader = false;\n                            }\n                        );\n                    } else {\n                        this.loader = false;\n                    }\n                });\n            },\n            (err) => {\n                this.loader = false;\n            }\n        );   \n    }\n\n    selectModule() {\n        for(const module_id of this.selected_modules) {\n\n            let i = this.controller.findObjectByKey(this.data.permissions, 'module_id', module_id);\n\n            if(i < 0) {\n                this.data.permissions.push({\n                    module_id: module_id,\n                    permissions: {\n                        browse: false,\n                        read: false,\n                        edit: false,\n                        add: false,\n                        delete: false\n                    }\n                });\n            }\n        }\n\n        for(const p of this.data.permissions) {\n            let i = this.selected_modules.indexOf(p.module_id);\n            let x = this.controller.findObjectByKey(this.data.permissions, 'module_id', p.module_id);\n            if(i < 0) this.data.permissions.splice(x, 1);\n        }\n    }\n\n    moduleName(id) {\n        for(const mod of this.modules) {\n            if(mod.id == id) {\n                return mod.name \n            }\n        }\n    }\n\n    save() {\n        let url = '';\n\n        if(this.id !== null && this.id !== undefined) {\n            url = `roles/update/${this.id}`;\n        } else {\n            url = `roles/store`;\n        }\n\n        this.controller.presentLoading('Saving, please wait...').then((loading) => {\n            this.api.post(url, this.data)\n            .subscribe(\n                (res: any) => {\n                    loading.dismiss();\n                    if(this.id == null || this.id == undefined) {\n                        this.data = {\n                            permissions: []\n                        };\n                        this.selected_modules = [];\n                    }\n                    this.controller.presentAlert('Success', res.message);\n                },\n                (err: any) => {\n                    loading.dismiss();\n                    this.controller.showErrorAlert(err);\n                }\n            )\n        });\n    }\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJyb2xlLWZvcm0ucGFnZS5zY3NzIn0= */\";","export default \"<app-navbar [title]=\\\"'ROLES'\\\" [icon]=\\\"'key-outline'\\\" [loader]=\\\"loader\\\">\\n    <div content>\\n        <button class=\\\"surelog-btn secondary-bg shadow border-0 right\\\" (click)=\\\"save()\\\">\\n            <ion-icon name=\\\"save-outline\\\"></ion-icon>\\n            &nbsp;\\n            <label>Save Role</label>\\n        </button>\\n        {{id == undefined || id == null ? 'Create' : 'Edit'}} Role\\n        <br><br>\\n\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-lg-4 col-md-6 col-12\\\">\\n                <label class=\\\"text-muted\\\">Name</label>\\n                <input type=\\\"name\\\" class=\\\"form-control form-control-sm\\\" required [(ngModel)]=\\\"data.name\\\">\\n            </div>\\n        </div>\\n\\n        <br>\\n\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-lg-4 col-md-6 col-12\\\">\\n                <label class=\\\"text-muted\\\">Select Accessible Module/s</label>\\n                <ion-select placeholder=\\\"Select Mdoule\\\" multiple=\\\"true\\\" class=\\\"form-control form-control-sm\\\" (ionChange)=\\\"selectModule()\\\" [(ngModel)]=\\\"selected_modules\\\">\\n                    <ion-select-option value=\\\"{{module.id}}\\\" *ngFor=\\\"let module of modules\\\">\\n                        {{module.name}}\\n                    </ion-select-option>\\n                </ion-select>\\n            </div>\\n        </div>\\n\\n        <br>\\n\\n        <div class=\\\"row\\\">\\n            <div class=\\\"col-lg-7 col-md-9 col-12\\\">\\n                <table class=\\\"table table-hover table-borderless data-table\\\">\\n                    <tbody>\\n                        <tr *ngFor=\\\"let permission of data.permissions\\\" class=\\\"bg-light data-row\\\">\\n                            <th style=\\\"vertical-align: text-top !important;\\\">{{moduleName(permission.module_id)}}</th>\\n                            <th>\\n                                <label class=\\\"switch mb-2\\\">\\n                                    <input type=\\\"checkbox\\\" [(ngModel)]=\\\"permission.permissions.browse\\\">\\n                                    <span class=\\\"slider round\\\"></span>\\n                                </label>&nbsp;&nbsp;&nbsp;&nbsp;Browse <br>\\n\\n                                <label class=\\\"switch mb-2\\\">\\n                                    <input type=\\\"checkbox\\\" [(ngModel)]=\\\"permission.permissions.read\\\">\\n                                    <span class=\\\"slider round\\\"></span>\\n                                </label>&nbsp;&nbsp;&nbsp;&nbsp;Read <br>\\n\\n                                <label class=\\\"switch mb-2\\\">\\n                                    <input type=\\\"checkbox\\\" [(ngModel)]=\\\"permission.permissions.edit\\\">\\n                                    <span class=\\\"slider round\\\"></span>\\n                                </label>&nbsp;&nbsp;&nbsp;&nbsp;Edit <br>\\n\\n                                <label class=\\\"switch mb-2\\\">\\n                                    <input type=\\\"checkbox\\\" [(ngModel)]=\\\"permission.permissions.add\\\">\\n                                    <span class=\\\"slider round\\\"></span>\\n                                </label>&nbsp;&nbsp;&nbsp;&nbsp;Add <br>\\n\\n                                <label class=\\\"switch mb-2\\\">\\n                                    <input type=\\\"checkbox\\\" [(ngModel)]=\\\"permission.permissions.delete\\\">\\n                                    <span class=\\\"slider round\\\"></span>\\n                                </label>&nbsp;&nbsp;&nbsp;&nbsp;Delete <br>\\n                            </th>\\n                        </tr>\\n                    </tbody>\\n                </table>\\n            </div>\\n        </div>\\n    </div>\\n</app-navbar>\";"],"sourceRoot":"webpack:///"}